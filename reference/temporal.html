<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add temporal error to data — temporal • denoiser</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add temporal error to data — temporal"><meta name="description" content="Error is generated through a vector autoregressive model with its defining
parameters parameters intercept, transition, and
covariance, which should be specified by the user. Note that the
temporal component of this model is defined on the residual level (i.e.,
residuals carry over over time), not on the data level (positions are not
carried over over time). See the details for more information."><meta property="og:description" content="Error is generated through a vector autoregressive model with its defining
parameters parameters intercept, transition, and
covariance, which should be specified by the user. Note that the
temporal component of this model is defined on the residual level (i.e.,
residuals carry over over time), not on the data level (positions are not
carried over over time). See the details for more information."><script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">denoiser</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-usage" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Usage</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-usage"><li><a class="dropdown-item" href="../articles/getting_started.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/noiser_vignette.html">Adding noise</a></li>
    <li><a class="dropdown-item" href="../articles/denoiser_vignette.html">Filtering data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/ndpvh/denoiser/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add temporal error to data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ndpvh/denoiser/blob/version/R/measurement_models.R"><code>R/measurement_models.R</code></a></small>
      <div class="d-none name"><code>temporal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Error is generated through a vector autoregressive model with its defining
parameters parameters <code>intercept</code>, <code>transition</code>, and
<code>covariance</code>, which should be specified by the user. Note that the
temporal component of this model is defined on the residual level (i.e.,
residuals carry over over time), not on the data level (positions are not
carried over over time). See the details for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">temporal</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.925</span>, <span class="fl">0.085</span>, <span class="fl">0.085</span>, <span class="fl">0.87</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.015</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.015</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  sampling_rate <span class="op">=</span> <span class="fl">6.13</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame containing the data on which to base the parameters
of the constant velocity model. This function assumes that this data.frame
contains the columns <code>"time"</code>, <code>"x"</code>, and <code>"y"</code> containing
the time at which the observed position (x, y) was measured respectively.</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>Numeric vector with 1 or 2 values containing the intercept
of the vector autoregressive model.If only 1 number is provided, then this
value will be assumed to represent the intercept for both the x- and y-
dimensions. Defaults to <code>c(0, 0)</code>, representing no bias in the system.</p></dd>


<dt id="arg-transition">transition<a class="anchor" aria-label="anchor" href="#arg-transition"></a></dt>
<dd><p>Numeric matrix of dimensionality \(2 \times 2\) having
the autoregressive effects on the diagonal and crossregressive effects on the
off-diagonal. Defaults to the autoregressive effects being equal to
<code>0.925</code> and <code>0.87</code> for the x- and y-dimension respectively, and
the cross-regressive effects being equal to <code>0.085</code> in a symmetric way.
These values represent the means of these parameters as found across the
four days of the calibration study that informed this project.</p></dd>


<dt id="arg-covariance">covariance<a class="anchor" aria-label="anchor" href="#arg-covariance"></a></dt>
<dd><p>Numeric matrix of dimensionality \(2 \times 2\),
having the variances of the errors for x and y on the diagonal and the
covariance of the errors on the off-diagonal. Defaults to having the variances
of the x- and y-dimension being equal to <code>0.031^2</code> and <code>0.027^2</code>
respectively, and the covariance being equal to <code>0.02</code>. These values
represent the means of the respective variances and covariances found
across the four days of the calibration study that informed this project.</p></dd>


<dt id="arg-sampling-rate">sampling_rate<a class="anchor" aria-label="anchor" href="#arg-sampling-rate"></a></dt>
<dd><p>Numeric denoting the sampling rate in Hz. Is used to
scale the transition matrix according to the actual sampling rate. Defaults to
<code>6.13</code>, which is the mean sampling rate for the data obtained across the
four days of the calibration study that informed this project. If you change
the <code>transition</code> argument, it is recommended to ignore this argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>data.frame</code> in which the <code>"x"</code> and <code>"y"</code> columns
have additional noise in them.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>According to this function, the observed positions \(\mathbf{y}_i\) at time
\(t_i\) contain error that in itself is temporally related, that is carried
over over time. Specifically, we assume that the error
\(\mathbf{\epsilon}_i\) at time \(t_i\) depends on the error
\(\mathbf{\epsilon}_{i - 1}\) at previous time \(t_{i - 1}\) and a white
noise residual at the same timepoint, as specified in the vector
autoregressive model. In symbols:</p>
<p>$$\mathbf{\epsilon}_i = \mathbf{\delta} + \Theta \mathbf{\epsilon}_{i - 1} + \mathbf{\omega}_i$$</p>
<p>with</p>
<p>$$\mathbf{\omega}_i \sim N(\mathbf{0}, \Sigma)$$
where \(\mathbf{\delta}\) represents the intercept of the model,
\(\Theta\) is the transition matrix defining the temporal carry-over, and
\(\Sigma\) is the covariance matrix of the white noise residuals
\(\mathbf{\omega}\). Note that for the vector autoregressive model, the
mean of the process is defined as:</p>
<p>$$\mathbf{\mu} = (I - \Theta)^{-1} \mathbf{\delta}$$
which is useful to keep in mind when specifying the intercept to add bias to
the system. Furthermore note that the covariance \(\Sigma_\epsilon\) of the
process \(\mathbf{\epsilon}\) is defined as:</p>
<p>$$\Sigma_\epsilon = \Sigma - \Theta \Sigma \Theta^T$$
which is useful to keep in mind when specifying the covariance matrix
\(\Sigma\), which is defined on the level of \(\mathbf{\omega}\).</p>
<p>Once the errors \(\mathbf{\epsilon}_i\) are defined, we compute the
observed positions \(\mathbf{y}_i\) as consisting of a systematic component
(i.e., the latent positions, provided in <code>data</code>) and the unsystematic
error component so that:</p>
<p>$$\mathbf{y}_i = \mathbf{x}_i + \mathbf{\epsilon}_i$$</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="noiser.html">noiser()</a></code>
<code><a href="independent.html">independent()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate data for illustration purposes. Movement in circular motion at a</span></span></span>
<span class="r-in"><span><span class="co"># pace of 1.27m/s with some added noise of SD = 10cm.</span></span></span>
<span class="r-in"><span><span class="va">angles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coordinates</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">angles</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">angles</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="va">coordinates</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">coordinates</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add independent noise to these data with an error variance of 0.01 in each</span></span></span>
<span class="r-in"><span><span class="co"># dimension and a transition matrix containing autoregressive effects of 0.15</span></span></span>
<span class="r-in"><span><span class="fu">temporal</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  transition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.15</span>,</span></span>
<span class="r-in"><span>  covariance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.01</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          x            y time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 9.742460 -0.008170467    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 9.871491  1.277113124    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 9.724273  2.552381774    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 9.212954  3.760601839    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 8.605056  4.885181521    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 7.844626  6.047900151    6</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niels Vanhasbroeck.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

