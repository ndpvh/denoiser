<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Innovation step in the Kalman filter — kf_innovation • denoiser</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Innovation step in the Kalman filter — kf_innovation"><meta name="description" content="Innovation step in the Kalman filter"><meta property="og:description" content="Innovation step in the Kalman filter"><script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">denoiser</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-usage" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Usage</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-usage"><li><a class="dropdown-item" href="../articles/getting_started.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/noiser_vignette.html">Adding noise</a></li>
    <li><a class="dropdown-item" href="../articles/denoiser_vignette.html">Filtering data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/ndpvh/denoiser/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Innovation step in the Kalman filter</h1>
      <small class="dont-index">Source: <a href="https://github.com/ndpvh/denoiser/blob/main/R/kalman_filter.R"><code>R/kalman_filter.R</code></a></small>
      <div class="d-none name"><code>kf_innovation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Innovation step in the Kalman filter</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kf_innovation</span><span class="op">(</span><span class="va">z</span>, <span class="va">x</span>, <span class="va">P</span>, <span class="va">H</span>, <span class="va">R</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>Vector of measured values at time t + 1</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Vector of predicted values of the movement equation at time t + 1.</p></dd>


<dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Cholesky decomposition of the estimation covariance matrix at time
t + 1.</p></dd>


<dt id="arg-h">H<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>Matrix relating the values in x to the values in y.</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Cholesky decomposition of the measurement noise covariance matrix.#'</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Named list of the innovation (<code>"y"</code>), the Cholesky decomposition
of its covariance matrix (<code>"S"</code>), and the Kalman gain (<code>"K"</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In the innovation step, we compute how much error we expect in the measurement
if the movement equation is correct in its prediction. The expected
"innovation" is defined as:</p>
<p>$$\mathbf{y}_i = \mathbf{z}_i - H \mathbf{x}_i$$
where \(\mathbf{z}\) is the measurement, \(H\) is the measurement matrix,
and \(\mathbf{x}\) is the prediction obtained through the prediction step.
We also compute the covariance matrix for this innovation, which is defined as:</p>
<p>$$\Sigma_i = H P_i H^T + R$$
where \(R\) contains the (assumed) measurement covariances. It is
interesting to note that the value of \(\Sigma\) is always symmetric for
each value of \(H\). Whether its Cholesky decomposition exists, however,
will depend on both \(H\) and \(P\).</p>
<p>In the final step, we compute the Kalman gain using both the covariance of
the prediction and the total covariance of the measurement process through
the following equation:</p>
<p>$$K_i = P_i H^T \Sigma_i^{-1}$$
As one may notice, the Kalman gain is a measure of how much we can trust the
prediction, specifically by putting the prediction covariance over the total
variance. It is thus related to a measure of reliability.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="kalman_filter.html">kalman_filter</a></code>,
<code><a href="kf_predict.html">kf_predict</a></code>,
<code><a href="kf_update.html">kf_update</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Niels Vanhasbroeck.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

